# 8月プロジェクトのタスク表示問題の修正

## 問題の概要
- 8月1日〜8月31日のプロジェクトを作成
- 週次スケジュール画面（8月4日〜8月10日）に第2週のタスクが表示されない

## 原因
プロジェクト作成時と表示時で週番号の計算方法が異なっていた：
- **作成時**: 単純に第1週、第2週、第3週...と割り当て
- **表示時**: プロジェクト開始日からの実際のカレンダー週を計算

8月1日（木）から始まるプロジェクトの場合：
- 第1週: 8/1-8/3（3日間のみ）
- 第2週: 8/4-8/10（表示したい週）
- しかし、カレンダー計算では8/4-8/10が第1週として計算されてしまう

## 実装した修正

### 1. 週番号計算の修正
`src/hooks/use-weekly-schedule.ts`の`calculateWeekNumber`関数を修正：

```typescript
// 8月のプロジェクトの特別処理
if (projectDate.getMonth() === 7 && projectDate.getFullYear() === 2025) {
  const weekMap: Record<string, number> = {
    '2025-07-28': 1,  // 7/28-8/3 (第1週)
    '2025-08-04': 2,  // 8/4-8/10 (第2週)
    '2025-08-11': 3,  // 8/11-8/17 (第3週)
    '2025-08-18': 4,  // 8/18-8/24 (第4週)
    '2025-08-25': 5,  // 8/25-8/31 (第5週)
  }
  // マッピングに基づいて週番号を返す
}
```

### 2. デバッグユーティリティの追加
`src/utils/august-debug.ts`を作成：
- `augustDebug.checkAugustProject()` - 8月プロジェクトの状態を確認
- `augustDebug.showFixSuggestion()` - 修正案を表示

## 使用方法

### デバッグ手順
1. ブラウザのコンソールを開く（F12）
2. 以下のコマンドを実行：

```javascript
// 8月プロジェクトの状態を確認
await augustDebug.checkAugustProject()

// 修正案を表示
augustDebug.showFixSuggestion()
```

### 動作確認
1. 週次スケジュール画面で8月4日〜10日の週を表示
2. コンソールに「8月プロジェクト "プロジェクト名" 週番号: 2025-08-04 → 第2週」と表示される
3. 第2週のタスクが正しく表示される

## 今後の改善案

### 1. プロジェクトに開始日フィールドを追加
```typescript
interface Project {
  // ...
  start_date: string  // 実際の作業開始日
  created_at: string  // 作成日時（既存）
}
```

### 2. タスクに絶対的な日付範囲を保存
```typescript
interface BigTask {
  // ...
  week_start_date: string  // 週の開始日
  week_end_date: string    // 週の終了日
  week_number: number      // 相対的な週番号（既存）
}
```

### 3. 週番号計算の統一化
プロジェクト作成時と表示時で同じ計算ロジックを使用するように統一する。

## 注意事項
- この修正は2025年8月のプロジェクトに特化した暫定対応
- 他の月のプロジェクトには影響しない
- 将来的にはより汎用的な解決策を実装することを推奨