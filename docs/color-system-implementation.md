# ModerationCraft カラーシステム実装ガイド

## 目次
1. [プロジェクト背景](#プロジェクト背景)
2. [デザイン哲学](#デザイン哲学)
3. [カラーシステム概要](#カラーシステム概要)
4. [実装済み機能](#実装済み機能)
5. [技術仕様](#技術仕様)
6. [使用方法](#使用方法)
7. [トラブルシューティング](#トラブルシューティング)
8. [今後の展開](#今後の展開)

## プロジェクト背景

### ModerationCraftとは
個人創作者（イラストレーター、作家、音楽家、動画制作者など）向けのセルフケア統合型プロジェクト管理アプリケーションです。

### なぜカラーシステムの刷新が必要だったか
- **従来**: モノクローム中心の冷たい印象のUI
- **課題**: 創作者向けツールとしての温かみや親しみやすさの不足
- **解決**: ブランドアイデンティティに沿った温かみのあるカラーシステムへの移行

## デザイン哲学

### コアバリュー
1. **創造性のサポート**: クリエイターの制作活動を色彩で支援
2. **ウェルビーイング**: 視覚的な快適さでメンタルヘルスに配慮
3. **持続可能性**: 長時間使用しても疲れない色彩設計
4. **親しみやすさ**: 冷たいツールではなく、寄り添うパートナー

### デザイン原則
- **ミニマル**: 過度な装飾を避け、コンテンツに集中
- **一貫性**: 全コンポーネントで統一された色彩表現
- **アクセシビリティ**: WCAG AA基準を満たすコントラスト比
- **柔軟性**: ライト/ダークモード対応

## カラーシステム概要

### カラーアーキテクチャ
```
┌─────────────────────────────────────────┐
│           カラーパレット層               │
│  ・基本色定義（HSL形式）                │
│  ・primary, accent, info, surface等      │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│         セマンティックカラー層           │
│  ・用途別の色定義                       │
│  ・ライト/ダークモード対応             │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│            CSS変数層                     │
│  ・実行時に切り替え可能                 │
│  ・テーマのカスタマイズ対応            │
└─────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────┐
│         ユーティリティクラス層           │
│  ・Tailwind CSS互換                     │
│  ・bg-*, text-*, shadow-*等             │
└─────────────────────────────────────────┘
```

## 実装済み機能

### Phase 1: 基本カラーシステム（✅ 完了）

#### 1. プライマリカラー（グリーン系）
| 項目 | 値 |
|------|--------|
| 色相 | グリーン系 |
| HSL値 | `137 42% 55%` |
| 印象 | 成長、創造性、安らぎ |
| 用途 | 主要CTA、成功状態、ポジティブアクション |

**設計意図**: 創作活動における「成長」と「創造性」を表現。彩度を42%に抑えることで、長時間見ても疲れない洗練された印象を実現。

#### 2. アクセントカラー（プライマリの明るいバリエーション）
| 項目 | 値 |
|------|--------|
| 色相 | グリーン系（プライマリと同系色） |
| HSL値 | `144 57% 80%` |
| 印象 | 軽やか、親しみやすさ |
| 用途 | ホバー状態、セカンダリアクション、情報ハイライト |

**設計意図**: プライマリカラーと統一感を保ちながら、インタラクティブ要素に軽やかさを追加。

#### 3. 機能的カラー
- **Success（成功）**: プライマリカラーと同じグリーン系
- **Destructive（エラー）**: `356 77% 47%` - 控えめな赤系
- **Warning（警告）**: グレー系を使用し、過度な警告感を避ける
- **Info（情報）**: プライマリの最も明るいバリエーション

**設計意図**: 機能的な色を最小限に抑え、視覚的なノイズを減らしながら必要な情報を伝達。



### Phase 2: Surface階層システム（✅ 完了）

グレースケールベースの5段階視覚的深度：

| レベル | 用途 | ライトモード（HSL） | ダークモード（HSL） |
|--------|------|------------------|------------------|
| Surface-0 | ページ背景 | `214 17% 94%` | `220 13% 9%` |
| Surface-1 | カード、パネル | `216 20% 97%` | `217 10% 13%` |
| Surface-2 | ホバー状態 | `216 20% 99%` | `217 10% 15%` |
| Surface-3 | モーダル、ダイアログ | `0 0% 100%` | `215 10% 17%` |
| Surface-4 | ツールチップ、ポップオーバー | `220 15% 96%` | `213 8% 20%` |

**設計原則**:
- **中立的な基調**: ブルーグレー系の落ち着いた階層
- **微細な差異**: 階層間の差を最小限に抑え、洗練された印象
- **影の排除**: フラットデザインを基調とし、色の違いのみで階層を表現
- **一貫性**: ライト/ダークモードで同じ階層感を維持

### Phase 3: タスクカラーシステム（✅ 完了）

#### タスクの色付けルール

##### 1. プロジェクトに紐づくタスク
| 要素 | 色の設定 |
|------|---------|
| 背景色 | プロジェクトカラーの調整版（彩度18%、明度82%） |
| 左ボーダー | プロジェクトの元の色（4px幅） |
| テキスト | `text-foreground`（通常の文字色） |

**実装詳細**:
```typescript
// HSLカラーを調整する関数（彩度18%、明度82%に設定）
const adjustHSLForBackground = (hslColor: string): string => {
  const match = hslColor.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/)
  if (!match) return hslColor
  
  const [, hue] = match
  return `hsl(${hue}, 18%, 82%)`
}
```

##### 2. プロジェクトが登録されていないタスク
| 要素 | 色の設定 |
|------|---------|
| 背景色 | `hsl(137, 5%, 82%)` - 薄い緑色 |
| 左ボーダー | `hsl(137, 8%, 15%)` - 濃い緑色（4px幅） |
| テキスト | `text-foreground`（通常の文字色） |

##### 3. 睡眠時間ブロック
| 要素 | 色の設定 |
|------|---------|
| 背景色 | 2層構造：`bg-background` + `bg-slate-800/20` |
| 左ボーダー | `hsl(137, 8%, 15%)` - 濃い緑色（4px幅） |
| テキスト | `text-slate-600` |

**設計意図**:
- プロジェクトカラーの彩度と明度を調整することで、長時間見ても疲れない薄い色を実現
- 左ボーダーに元の色を使用することで、プロジェクトの識別性を保持
- プロジェクトなしのタスクと睡眠時間は同じボーダー色で統一感を演出

## 実装時の注意事項

### 禁止事項（必ず守ること）

#### ❌ 直接的な色指定の禁止
```tsx
// ❌ 悪い例
<div className="text-gray-400 bg-red-50 border-blue-200">
<div className="text-red-600 hover:text-red-800">

// ✅ 良い例
<div className="text-muted-foreground bg-destructive/10 border-border">
<div className="text-destructive hover:text-destructive-foreground">
```

#### ❌ インラインスタイルでの色指定
```tsx
// ❌ 悪い例
<div style={{ color: '#656D76', backgroundColor: '#F8F9FA' }}>

// ✅ 良い例
<div className="text-foreground bg-surface-1">
```

#### ❌ ハードコードされた色コード
```tsx
// ❌ 悪い例
const errorColor = '#D1242F'
const bgColor = 'rgb(248, 249, 250)'

// ✅ 良い例
// セマンティックカラーを使用（CSS変数経由）
<div className="text-destructive bg-surface-1">
```

### 推奨パターン

#### エラー表示
```tsx
// エラーメッセージ
<div className="bg-destructive/10 border border-destructive/20 rounded-lg p-4">
  <p className="text-destructive">エラーが発生しました</p>
</div>
```

#### 成功・情報表示
```tsx
// 成功メッセージ
<div className="bg-accent/10 border border-accent/20 rounded-lg p-4">
  <p className="text-accent-foreground">正常に保存されました</p>
</div>

// 情報表示
<div className="bg-surface-1 rounded-lg p-4">
  <p className="text-muted-foreground">補足情報</p>
</div>
```

#### カード・パネル
```tsx
// 基本的なカード
<Card className="bg-surface-1 border border-border">
  <CardContent>コンテンツ</CardContent>
</Card>

// ホバー可能なカード
<Card className="bg-surface-1 hover:bg-surface-2 transition-colors">
  <CardContent>インタラクティブコンテンツ</CardContent>
</Card>
```

### 透明度の使用
セマンティックカラーに透明度を適用する場合：
```tsx
// Tailwind CSSの透明度記法を使用
<div className="bg-primary/10">   // 10%の透明度
<div className="bg-accent/20">    // 20%の透明度
<div className="text-destructive/50"> // 50%の透明度
```

## 使用方法

### 開発環境での設定

#### 1. カラー定義の更新
```bash
# colors.tsを編集後、CSS変数を再生成
npm run generate:css
```

#### 2. 開発サーバーの起動
```bash
npm run dev
# http://localhost:3000 でカラー変更を確認
```

### 実装パターン集

#### 基本的な使用方法
```tsx
// プライマリカラーの使用
<Button className="bg-primary text-primary-foreground">
  メインアクション
</Button>

// アクセントカラーでのホバー効果
<Card className="hover:border-accent hover:shadow-accent/20">
  <CardContent>インタラクティブなカード</CardContent>
</Card>

// Surface階層の適用
<div className="bg-surface-0">           {/* 背景 */}
  <Card className="bg-surface-1 shadow-surface-1">  {/* カード */}
    <Button className="hover:bg-surface-2">         {/* ホバー */}
      アクション
    </Button>
  </Card>
</div>
```


#### ダークモード対応
```tsx
// 自動的にダークモード対応
<div className="bg-surface-1 text-foreground">
  ライト/ダークモードで自動的に切り替わります
</div>
```

## トラブルシューティング

### よくある問題と解決方法

#### Q1: カラーが反映されない
**原因**: CSS変数が生成されていない
**解決方法**:
```bash
npm run generate:css
# ブラウザのキャッシュをクリア（Cmd/Ctrl + Shift + R）
```

#### Q2: TypeScriptエラーが発生する
**原因**: colors.tsの型定義の不整合
**解決方法**:
```typescript
// 型定義を確認
export type SemanticColor = keyof typeof lightColors
```

#### Q3: コントラスト比が不足している
**確認方法**:
- Chrome DevToolsのLighthouseを使用
- [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)で確認

**解決方法**:
```typescript
// foreground色を調整してコントラスト比4.5:1以上を確保
'primary-foreground': colorPalette.gray[50], // 明るい背景用
```

#### Q4: 新しいカラーを追加したい
**手順**:
1. `colors.ts`のcolorPaletteに追加
2. lightColors/darkColorsに追加
3. `npm run generate:css`を実行
4. globals.cssにユーティリティクラスを追加（必要に応じて）

## 今後の展開

### Phase 4: アニメーションシステム（計画中）
- カラートランジションの実装
- インタラクション時の視覚的フィードバック強化
- マイクロアニメーションの追加

### Phase 5: テーマカスタマイズ機能（検討中）
- ユーザー定義のカラーテーマ
- プリセットテーマの提供
- アクセシビリティモード（高コントラストなど）

### Phase 6: デザイントークンの拡張（将来構想）
- スペーシング、タイポグラフィの統合管理
- Design Tokens Formatへの準拠
- Figmaとの連携強化

## 設計の背景と決定事項

### 改訂カラーパレットの選定理由

#### 70-20-10ルールの採用
1. **視覚的バランス**: デザインの基本原則に沿った配分
2. **認知負荷の軽減**: ユーザーが直感的に理解できる階層
3. **長時間使用への配慮**: 視覚的な疲れを最小限に

#### ウォームグレー（ベース）を選んだ理由
1. **中立性と温かみの両立**: 情報表示に適した落ち着き
2. **大面積使用に耐える**: 主張が強すぎない優しい色
3. **プロフェッショナルな印象**: 信頼感と安定感

#### ディープテラコッタ（プライマリ）を選んだ理由
1. **洗練された温かみ**: バーントシエナより落ち着いた印象
2. **適度な存在感**: 20%の使用に適した彩度
3. **ブランドアイデンティティ**: 温かみを保ちながらプロフェッショナル

#### バーントシエナ（アクセント）を選んだ理由
1. **際立つアクセント**: 10%の限定使用で最大効果
2. **ブランドの個性**: 記憶に残る特徴的な色
3. **行動促進**: 重要なCTAに最適

### なぜHSL形式を採用したか
1. **明度調整の容易さ**: ダークモード対応が直感的
2. **彩度の統一**: ブランドの一貫性を保ちやすい
3. **CSS互換性**: CSS変数として直接使用可能

### なぜシンプルなカラーシステムにしたか
1. **認知負荷の減少**: 過度な色彩が創作活動の邪魔にならない
2. **統一感**: グレースケールとグリーンの最小限の色彩
3. **メンテナンス性**: カラーパレットの管理が簡潔

### なぜ5段階のSurface階層なのか
- Material Design（24段階）は複雑すぎる
- 3段階では表現力が不足
- 5段階が認知負荷と表現力のバランスが最適


## 関連リソース

### 内部ドキュメント
- `/src/lib/theme/colors.ts` - カラー定義ファイル
- `/scripts/generate-css-vars.ts` - CSS変数生成スクリプト
- `/CLAUDE.md` - プロジェクト全体のガイドライン

### 外部リソース
- [shadcn/ui](https://ui.shadcn.com/) - UIコンポーネントライブラリ
- [Tailwind CSS](https://tailwindcss.com/) - CSSフレームワーク
- [WCAG 2.1](https://www.w3.org/WAI/WCAG21/quickref/) - アクセシビリティガイドライン

## 重要なポイント

### セマンティックカラーの使用を徹底
- 直接的な色指定（`text-gray-*`, `bg-red-*`など）は禁止
- 必ずセマンティックカラー（`text-foreground`, `bg-surface-1`など）を使用
- 透明度の指定はTailwind CSSの記法（`/10`, `/20`など）を使用


---

最終更新: 2025-07-29
作成者: Claude (Anthropic)
バージョン: 2.0
