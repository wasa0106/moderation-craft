# 日付範囲による週次タスク管理への移行

## 概要
週番号（第1週、第2週...）から絶対的な日付範囲（7/7-7/13）による管理に移行しました。これにより週番号の計算による混乱を解消します。

## 実装内容

### 1. BigTaskの型定義を拡張
```typescript
export interface BigTask extends DatabaseEntity {
  // ... 既存のフィールド
  week_number: number              // 互換性のため残す
  week_start_date?: string         // 週の開始日（ISO 8601形式）
  week_end_date?: string           // 週の終了日（ISO 8601形式）
}
```

### 2. WBSReferencePanelの表示改善
- 「今週のタスク（第2週）」→「今週のタスク（8/4 - 8/10）」
- 「来週のタスク（第3週）」→「来週のタスク（8/11 - 8/17）」

### 3. タスクフィルタリングの改善
日付範囲によるフィルタリングを優先：
1. `week_start_date`と`week_end_date`がある場合は日付範囲でフィルタリング
2. ない場合は従来の`week_number`ベースのフィルタリングにフォールバック

### 4. プロジェクト作成時の処理
新規作成されるBigTaskには自動的に日付範囲が設定されます。

## 既存データの移行

### 移行状況の確認
```javascript
// ブラウザコンソールで実行
await migrationUtils.checkMigrationStatus()
```

このコマンドで以下が表示されます：
- 日付範囲ありのタスク数
- 日付範囲なしのタスク数
- 日付範囲がないタスクのリスト

### 既存タスクに日付範囲を追加
```javascript
// ブラウザコンソールで実行
await migrationUtils.addDateRangesToExistingTasks()
```

このコマンドで：
1. 各BigTaskのプロジェクトを検索
2. プロジェクト開始日と週番号から日付範囲を計算
3. `week_start_date`と`week_end_date`を設定

## 利点

### 1. 週番号の混乱を解消
- プロジェクト開始日が週の途中でも正確に表示
- 「第2週」が実際にいつなのか明確に

### 2. 直感的な表示
- 「8/4 - 8/10」のような具体的な日付範囲
- カレンダーとの対応が一目瞭然

### 3. 柔軟なタスク管理
- 週をまたぐタスクも対応可能（将来拡張）
- プロジェクト間での週の違いを吸収

## 今後の拡張案

### 1. UIの改善
- タスクカードに日付範囲を表示
- カレンダービューでの視覚的表現

### 2. 週をまたぐタスク
- 2週間にわたるタスクの対応
- 部分的な週のタスク（月〜水のみなど）

### 3. プロジェクトテンプレート
- 標準的な週配分パターンの保存
- 休日・祝日を考慮した自動調整

## トラブルシューティング

### タスクが表示されない場合
1. 移行状況を確認：`migrationUtils.checkMigrationStatus()`
2. 日付範囲がない場合は移行を実行
3. デバッグ情報を確認：コンソールのログを参照

### 日付範囲が正しくない場合
1. プロジェクトの開始日を確認
2. 週番号の計算ロジックを確認
3. 必要に応じて手動で修正

## 互換性

- 既存の`week_number`フィールドは維持
- 段階的な移行が可能
- 古いデータも正常に動作