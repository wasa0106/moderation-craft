version: 2

models:
  - name: stg_fitbit_sleep_json
    description: "Fitbit睡眠データのステージング層"
    columns:
      - name: id
        description: "ユーザーと日付の組み合わせによる一意識別子"
        tests:
          - unique
          - not_null
      - name: user_id
        description: "ユーザーID"
        tests:
          - not_null
      - name: sleep_date
        description: "睡眠日"
        tests:
          - not_null
      - name: duration_ms
        description: "Fitbitが計測した総睡眠時間（ミリ秒）"
      - name: sleep_efficiency
        description: "睡眠効率（%）"
      - name: minutes_asleep
        description: "実睡眠時間（分）"
      - name: minutes_awake
        description: "覚醒時間（分）"
      - name: time_in_bed
        description: "ベッドにいた時間（分）"
      - name: deep_sleep_minutes
        description: "深い睡眠の時間（分）"
      - name: light_sleep_minutes
        description: "浅い睡眠の時間（分）"
      - name: rem_sleep_minutes
        description: "REM睡眠の時間（分）"
      - name: wake_minutes
        description: "覚醒時間（分）"
      - name: sleep_start_time
        description: "就寝時刻"
      - name: sleep_end_time
        description: "起床時刻"
      - name: is_main_sleep
        description: "メインの睡眠セッションかどうか"
      - name: fetched_at
        description: "データ取得時刻"
      - name: source_date
        description: "S3メタデータ上の日付"
      - name: extracted_at
        description: "ETL抽出タイムスタンプ"
      - name: processed_at
        description: "ステージング処理時刻（JST）"

  - name: stg_fitbit_activity_json
    description: "Fitbit活動データのステージング層"
    columns:
      - name: id
        description: "ユーザーと日付の組み合わせによる一意識別子"
        tests:
          - unique
          - not_null
      - name: user_id
        description: "ユーザーID"
        tests:
          - not_null
      - name: activity_date
        description: "活動日"
        tests:
          - not_null
      - name: steps
        description: "歩数"
      - name: distance_km
        description: "移動距離（km）"
      - name: calories_burned
        description: "消費カロリー"
      - name: calories_bmr
        description: "基礎代謝によるカロリー"
      - name: activity_calories
        description: "活動によるカロリー"
      - name: floors_climbed
        description: "上った階数"
      - name: elevation_meters
        description: "獲得標高（m）"
      - name: sedentary_minutes
        description: "座位時間（分）"
      - name: lightly_active_minutes
        description: "低強度活動時間（分）"
      - name: fairly_active_minutes
        description: "中強度活動時間（分）"
      - name: very_active_minutes
        description: "高強度活動時間（分）"
      - name: fetched_at
        description: "データ取得時刻"
      - name: source_date
        description: "S3メタデータ上の日付"
      - name: extracted_at
        description: "ETL抽出タイムスタンプ"
      - name: processed_at
        description: "ステージング処理時刻（JST）"

  - name: stg_work_sessions
    description: "作業セッションデータのステージング層（DynamoDBエクスポートから抽出）"
    columns:
      - name: session_id
        description: "セッションID（主キー）"
        tests:
          - unique
          - not_null
      - name: user_id
        description: "ユーザーID"
        tests:
          - not_null
      - name: project_id
        description: "プロジェクトID"
      - name: small_task_id
        description: "小タスクID"
      - name: start_time
        description: "セッション開始時刻（UTC）"
        tests:
          - not_null
      - name: end_time
        description: "セッション終了時刻（UTC）"
        tests:
          - not_null
      - name: duration_seconds
        description: "セッション時間（秒）"
        tests:
          - not_null
      - name: focus_level
        description: "集中度レベル"
      - name: mood_rating
        description: "気分評価"
      - name: dopamine_level
        description: "ドーパミンレベル"
      - name: notes
        description: "セッションノート"
      - name: created_at
        description: "レコード作成タイムスタンプ"
      - name: updated_at
        description: "レコード更新タイムスタンプ"
      - name: processed_at
        description: "ステージング処理時刻（JST）"

  - name: stg_projects
    description: "プロジェクトデータのステージング層（DynamoDBエクスポートから抽出）"
    columns:
      - name: project_id
        description: "プロジェクトID（主キー）"
        tests:
          - unique
          - not_null
      - name: user_id
        description: "ユーザーID"
        tests:
          - not_null
      - name: project_name
        description: "プロジェクト名"
        tests:
          - not_null
      - name: description
        description: "プロジェクトの目標・説明"
      - name: color
        description: "プロジェクトカラー（HSL形式）"
      - name: status
        description: "プロジェクトステータス（active/completed/cancelled）"
      - name: deadline
        description: "プロジェクト締切日"
      - name: estimated_total_hours
        description: "見積もり総時間"
      - name: version
        description: "バージョン番号"
      - name: created_at
        description: "レコード作成タイムスタンプ"
      - name: updated_at
        description: "レコード更新タイムスタンプ"
      - name: processed_at
        description: "ステージング処理時刻（JST）"

  - name: stg_small_tasks
    description: "小タスクデータのステージング層（DynamoDBエクスポートから抽出）"
    columns:
      - name: task_id
        description: "タスクID（主キー）"
        tests:
          - unique
          - not_null
      - name: user_id
        description: "ユーザーID"
        tests:
          - not_null
      - name: project_id
        description: "プロジェクトID"
      - name: big_task_id
        description: "大タスクID"
      - name: task_name
        description: "タスク名"
        tests:
          - not_null
      - name: description
        description: "タスクの目標・説明"
      - name: status
        description: "タスクステータス（pending/in_progress/completed/cancelled）"
      - name: task_type
        description: "タスクタイプ（project/routine/flow）"
      - name: is_emergency
        description: "緊急タスクフラグ"
      - name: is_reportable
        description: "レポート対象フラグ"
      - name: estimated_minutes
        description: "見積もり時間（分）"
      - name: scheduled_start
        description: "予定開始時刻"
      - name: scheduled_end
        description: "予定終了時刻"
      - name: recurrence_enabled
        description: "繰り返し有効フラグ"
      - name: created_at
        description: "レコード作成タイムスタンプ"
      - name: updated_at
        description: "レコード更新タイムスタンプ"
      - name: processed_at
        description: "ステージング処理時刻（JST）"

  - name: stg_big_tasks
    description: "大タスク（BigTask）データのステージング層（DynamoDBエクスポートから抽出）"
    columns:
      - name: big_task_id
        description: "大タスクID（主キー）"
        tests:
          - unique
          - not_null
      - name: user_id
        description: "ユーザーID"
        tests:
          - not_null
      - name: project_id
        description: "プロジェクトID"
      - name: big_task_name
        description: "大タスク名"
        tests:
          - not_null
      - name: category
        description: "カテゴリ（開発/設計/テスト/対策/運動/案件/その他）"
      - name: status
        description: "ステータス（active/completed/cancelled）"
      - name: task_type
        description: "タスクタイプ（flow/routine）"
      - name: estimated_hours
        description: "見積もり時間（時間）"
      - name: actual_hours
        description: "実績時間（時間）"
      - name: start_date
        description: "開始日"
      - name: end_date
        description: "終了日"
      - name: version
        description: "バージョン番号"
      - name: created_at
        description: "レコード作成タイムスタンプ"
      - name: updated_at
        description: "レコード更新タイムスタンプ"
      - name: processed_at
        description: "ステージング処理時刻（JST）"
